1. 接下來我將與你進行此專案重大的重構，請記住以下需求及前提:

    1. 所有過程以正體中文進行交談
    1. 此過程需以討論方式得到明確的結論需求後，提供"進行修改"的指示後，才進行程式的產生或修改，切勿要直接進行
    以上回覆是否了解

1. @workspace 請讀取並了解我目前開發中的專案全部內容，此用於金融相關的應用，再針對有關券商 API 整合這個主題, 請先整理提供你的理解後提出深入的說明，後續我們再據以進行討論，再整理得到程式的實作或修改需求


1. 這裡有另一個新的通用介面定義, finfun-utif, 此要用於進一步重構整個相關的內容, 請加以理解，並加以深入分析比較 ttif, 提出是否ttif 有可以參考借鏡之處 最後提出有無對uitf的改善建議

    對 utif 的改善建議, utif 的設計已經非常出色，但仍有一些可以探討或強化的方向：

    1. 連線狀態管理: UTIF 介面中雖然有 is_connected() 方法，但可以考慮增加一個更明確的連線狀態事件。例如，在連線中斷或成功重連時，可以透過事件佇列發出 ConnectionStatusEvent，讓上層應用能即時反應（例如在 UI 上顯示斷線圖示）。

    1. 合約資訊的獲取與快取: quote.contracts() 方法定義了獲取合約的介面。在實務上，合約資訊不常變動但資料量龐大。建議可以在 utif 的抽象層級或實作指引中，加入一個標準的快取機制（例如，每日更新一次並儲存於本地檔案），避免每次啟動都需重新向券商伺服器請求完整的合約清單，以加速啟動時間。

    1. 交易介面 (UTIFTrade) 的細化:

        - 平倉操作: 目前有 place_order，但可以考慮新增一個語意更明確的 close_position(position, ...) 方法。這個方法內部可以根據部位資訊自動產生對應的平倉單，簡化上層應用的邏輯。
        - 演算法訂單: 隨著需求發展，可以預先在介面中為更複雜的訂單類型（如 TWAP, VWAP）預留擴充空間，即使初期不實作。
    1. 文件與註解: utif 作為一個全新的核心介面，非常建議在 core.py 的抽象方法中加入更詳細的 docstring，說明每個參數的意義、函式的預期行為、以及可能拋出的主要例外。這將極大地幫助未來實作新的券商介面或維護現有程式碼的開發者。

1. 請依你所提出對提出的" finfun-utif 專案的改善建議", 「進行修改」

1. 我要將整個專案的相關內容, 如券商實作整合新的utif, 在先不影響現有運作下, 逐步實作utif, 並過渡過去, 請分析目前的現況後, 提出best practice 建議方案，並詳細說明做法與內容, 還不改動程式
   逐步遷移策略
        階段一：基礎設施準備 (2-3週)
        1.1 建立橋接層 (Adapter Pattern)
        橋接層功能：

        將現有 TTIF QuoteAPI/TradeAPI 包裝成 UTIF 介面
        資料模型自動轉換（ttif.dataclass ↔ utif.data_models）
        事件機制轉換（callback → asyncio.Queue）
        1.2 建立測試環境
        階段二：券商實作遷移 (每個券商 2-3週)
        2.1 券商實作遷移優先順序
        建議按照以下順序進行：

        永豐 (Sino) - API 最穩定，文件完整
        富邦 (Fubon) - 相對簡單的 SDK
        群益 (Capital) - COM 介面複雜度中等
        元大 (Yuanta) - .NET DLL 最複雜
        2.2 每個券商的遷移步驟
        步驟 2.2.1：建立新的 UTIF 實作

        步驟 2.2.2：漸進式切換機制 在現有券商套件中加入 UTIF 支援：

        階段三：上層應用適配 (每個應用 1-2週)
        3.1 配置檔擴充
        3.2 服務層雙介面支援
        階段四：效能最佳化與清理 (2-3週)
        4.1 移除橋接層
        當所有組件都完成遷移後，移除中間的橋接適配器，直接使用原生 UTIF 實作。

        4.2 舊程式碼清理
        逐步移除不再使用的 TTIF 相關程式碼。

1. 讓我們逐步實現遷移策略，請你同步產生遷移策略文件，以及逐步將遷移過程記錄在文件中，首先請產生建立新專案，實現1.1 建立橋接層 (Adapter Pattern), 請進行產生及修改

    1. 再提供 shioaji 專案，它是永豐証(sino)定義的API, , 請詳細檢視其內容做為參考，並讓我們先回到 finfu-utif 的定義，用shioaji 來檢視 utif是否有改善的地方，並是否定義的修改上可降低永豐証(sino)在實作utif的effort, 請先提出看法，還不修改

    1.請依照你所有的發現及改善建議, 對finfun-utif進行全面, 所有的調整改善, 對最後再進一步依改善的內容也對bridge做出相應的修改

1. 回到我們最初是要執行"FINFUN TTIF → UTIF 遷移策略實施", 目前應是完成了1.1 建立橋接層 (Adapter Pattern)，在這過程也重整了uuif的介面定莪，並有許多改變，請重新對目前的實際實施情況做一下總結，再進一步提出下一步的建議說明，同時對此文件"TTIF_TO_UTIF_MIGRATION.md"重新review與修正正確的內容

